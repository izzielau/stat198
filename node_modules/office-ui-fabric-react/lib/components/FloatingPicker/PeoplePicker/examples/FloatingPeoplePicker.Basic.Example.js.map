{"version":3,"file":"FloatingPeoplePicker.Basic.Example.js","sourceRoot":"../src/","sources":["components/FloatingPicker/PeoplePicker/examples/FloatingPeoplePicker.Basic.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { IPersonaProps } from 'office-ui-fabric-react/lib/Persona';\nimport {\n  IBaseFloatingPicker,\n  IBaseFloatingPickerSuggestionProps,\n  FloatingPeoplePicker,\n  SuggestionsStore,\n} from 'office-ui-fabric-react/lib/FloatingPicker';\nimport { SearchBox } from 'office-ui-fabric-react/lib/SearchBox';\nimport { people } from '@uifabric/example-data';\nimport { useConst } from '@uifabric/react-hooks';\n\nconst searchBoxWrapperStyling = { width: 208 };\n\nconst getTextFromItem = (persona: IPersonaProps): string => {\n  return persona.text || '';\n};\n\nconst listContainsPersona = (persona: IPersonaProps, personas?: IPersonaProps[]): boolean => {\n  return !!personas && personas.some((item: IPersonaProps) => item.text === persona.text);\n};\n\nconst validateInput = (input: string): boolean => {\n  return input.indexOf('@') !== -1;\n};\n\nconst startsWith = (text: string, filterText: string): boolean => {\n  return text.toLowerCase().indexOf(filterText.toLowerCase()) === 0;\n};\n\nexport const FloatingPeoplePickerTypesExample: React.FunctionComponent = () => {\n  const inputElementRef = React.useRef<HTMLInputElement>(null);\n  const suggestionsStore = useConst(() => new SuggestionsStore<IPersonaProps>());\n  const [peopleList, setPeopleList] = React.useState(people);\n  const [searchValue, setSearchValue] = React.useState('');\n  const picker = React.useRef<IBaseFloatingPicker>(null);\n\n  const onFocus = (): void => {\n    if (picker.current) {\n      picker.current.showPicker();\n    }\n  };\n\n  const onSearchChange = (ev: React.ChangeEvent<HTMLInputElement>, newValue: string): void => {\n    if (newValue !== searchValue && picker.current) {\n      setSearchValue(newValue);\n      picker.current.onQueryStringChanged(newValue);\n    }\n  };\n\n  const onPickerChange = (selectedSuggestion: IPersonaProps): void => {\n    setSearchValue(selectedSuggestion.text || '');\n    if (picker.current) {\n      picker.current.hidePicker();\n    }\n  };\n\n  const onRemoveSuggestion = (item: any): void => {\n    const itemIndex = peopleList.indexOf(item);\n    if (itemIndex >= 0) {\n      setPeopleList(peopleList.slice(0, itemIndex).concat(peopleList.slice(itemIndex + 1)));\n    }\n  };\n\n  const suggestionProps: IBaseFloatingPickerSuggestionProps = useConst(() => {\n    return {\n      footerItemsProps: [\n        {\n          renderItem: () => {\n            return <>Showing {picker.current ? picker.current.suggestions.length : 0} results</>;\n          },\n          shouldShow: () => {\n            return !!picker.current && picker.current.suggestions.length > 0;\n          },\n        },\n      ],\n    };\n  });\n\n  const onFilterChanged = (filterText: string, currentPersonas?: IPersonaProps[]): IPersonaProps[] => {\n    if (filterText) {\n      // Filter by items starting with the current filter text, then remove duplicates\n      return peopleList\n        .filter((item: IPersonaProps) => startsWith(item.text || '', filterText))\n        .filter((persona: IPersonaProps) => !listContainsPersona(persona, currentPersonas));\n    }\n    return [];\n  };\n\n  return (\n    <>\n      <div style={searchBoxWrapperStyling} ref={inputElementRef}>\n        <SearchBox placeholder=\"Search for person\" onChange={onSearchChange} value={searchValue} onFocus={onFocus} />\n      </div>\n      <FloatingPeoplePicker\n        suggestionsStore={suggestionsStore}\n        onResolveSuggestions={onFilterChanged}\n        getTextFromItem={getTextFromItem}\n        pickerSuggestionsProps={suggestionProps}\n        key=\"normal\"\n        onRemoveSuggestion={onRemoveSuggestion}\n        onValidateInput={validateInput}\n        componentRef={picker}\n        onChange={onPickerChange}\n        inputElement={inputElementRef.current}\n        resolveDelay={300}\n      />\n    </>\n  );\n};\n"]}