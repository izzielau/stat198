var FluentUIReactFocus=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e){t.exports=React},,function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r={},o=void 0;try{o=window}catch(t){}function i(t,e){if(void 0!==o){var n=o.__packages__=o.__packages__||{};if(!n[t]||!r[t])r[t]=e,(n[t]=n[t]||[]).push(e)}}i("@uifabric/set-version","6.0.0")},function(t,e,n){"use strict";n.r(e),n.d(e,"FocusZone",(function(){return Zt})),n.d(e,"FocusZoneTabbableElements",(function(){return l})),n.d(e,"FocusZoneDirection",(function(){return a}));var r=n(2);Object(r.a)("@fluentui/react-focus","7.12.17");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r}var a,u=n(0),l={none:0,all:1,inputOnly:2};function c(t,e){return void 0===e&&(e=!0),t&&(e&&function(t){var e,n;return t&&((n=t)&&n._virtual)&&(e=t._virtual.parent),e}(t)||t.parentNode&&t.parentNode)}function f(t,e){return t&&t!==document.body?e(t)?t:f(c(t),e):null}function h(t,e,n){void 0===n&&(n=!0);var r=!1;if(t&&e)if(n)for(r=!1;e;){var o=c(e);if(o===t){r=!0;break}e=o}else t.contains&&(r=t.contains(e));return r}!function(t){t[t.vertical=0]="vertical",t[t.horizontal=1]="horizontal",t[t.bidirectional=2]="bidirectional",t[t.domOrder=3]="domOrder"}(a||(a={}));var p=!1;var d=void 0;try{d=window}catch(t){}function v(t){if(!p&&void 0!==d){var e=t;return e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:d}}function m(t){if(!p&&"undefined"!=typeof document){var e=t;return e&&e.ownerDocument?e.ownerDocument:document}}function _(t,e,n,r,o,i,s,a){if(!e||!s&&e===t)return null;var u=b(e);if(o&&u&&(i||!E(e)&&!w(e))){var l=_(t,e.lastElementChild,!0,!0,!0,i,s,a);if(l){if(a&&y(l,!0)||!a)return l;var c=_(t,l.previousElementSibling,!0,!0,!0,i,s,a);if(c)return c;for(var f=l.parentElement;f&&f!==e;){var h=_(t,f.previousElementSibling,!0,!0,!0,i,s,a);if(h)return h;f=f.parentElement}}}if(n&&u&&y(e,a))return e;var p=_(t,e.previousElementSibling,!0,!0,!0,i,s,a);return p||(r?null:_(t,e.parentElement,!0,!1,!1,i,s,a))}function g(t,e,n,r,o,i,s,a){if(!e||e===t&&o&&!s)return null;var u=b(e);if(n&&u&&y(e,a))return e;if(!o&&u&&(i||!E(e)&&!w(e))){var l=g(t,e.firstElementChild,!0,!0,!1,i,s,a);if(l)return l}if(e===t)return null;var c=g(t,e.nextElementSibling,!0,!0,!1,i,s,a);return c||(r?null:g(t,e.parentElement,!1,!1,!0,i,s,a))}function b(t){if(!t||!t.getAttribute)return!1;var e=t.getAttribute("data-is-visible");return null!=e?"true"===e:0!==t.offsetHeight||null!==t.offsetParent||!0===t.isVisible}function y(t,e){if(!t||t.disabled)return!1;var n=0,r=null;t&&t.getAttribute&&(r=t.getAttribute("tabIndex"))&&(n=parseInt(r,10));var o=t.getAttribute?t.getAttribute("data-is-focusable"):null,i=null!==r&&n>=0,s=!!t&&"false"!==o&&("A"===t.tagName||"BUTTON"===t.tagName||"INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName||"true"===o||i);return e?-1!==n&&s:s}function E(t){return!!(t&&t.getAttribute&&t.getAttribute("data-focuszone-id"))}function w(t){return!(!t||!t.getAttribute||"true"!==t.getAttribute("data-is-sub-focuszone"))}function F(t,e){return"true"!==function(t,e){var n=f(t,(function(t){return t.hasAttribute(e)}));return n&&n.getAttribute(e)}(t,e)}var A,C=9,x=13,T=32,I=33,O=34,k=35,D=36,N=37,P=38,S=39,M=40;function R(t){A!==t&&(A=t)}function L(){return void 0===A&&(A="undefined"!=typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),A}function z(){return{rtl:L()}}A=L();var K;function j(t){if(void 0===t&&(t={}),void 0!==t.rtl)return t.rtl;if(void 0===K){var e=function(t){var e=null;try{e=window.sessionStorage.getItem(t)}catch(t){}return e}("isRTL");null!==e&&function(t,e){void 0===e&&(e=!1);var n=m();n&&n.documentElement.setAttribute("dir",t?"rtl":"ltr");e&&function(t,e){try{window.sessionStorage.setItem(t,e)}catch(t){}}("isRTL",t?"1":"0");R(K=t)}(K="1"===e);var n=m();void 0===K&&n&&R(K="rtl"===(n.body&&n.body.getAttribute("dir")||n.documentElement.getAttribute("dir")))}return!!K}function Z(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.length<2?e[0]:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e.forEach((function(e){return e&&e.apply(t,n)}))}}function W(t){!function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=Z(t,t[n],e[n]))}(t,{componentDidMount:B,componentDidUpdate:U,componentWillUnmount:H})}function B(){q(this.props.componentRef,this)}function U(t){t.componentRef!==this.props.componentRef&&(q(t.componentRef,null),q(this.props.componentRef,this))}function H(){q(this.props.componentRef,null)}function q(t,e){t&&("object"==typeof t?t.current=e:"function"==typeof t&&t(e))}var V,X=0,$=1,G=2,J="undefined"!=typeof navigator&&/rv:11.0/.test(navigator.userAgent),Q={};try{Q=window}catch(t){}var Y=function(){function t(t){this._rules=[],this._preservedRules=[],this._rulesToInsert=[],this._counter=0,this._keyToClassName={},this._onResetCallbacks=[],this._classNameToArgs={},this._config=i({injectionMode:$,defaultPrefix:"css",namespace:void 0,cspSettings:void 0},t),this._keyToClassName=this._config.classNameCache||{}}return t.getInstance=function(){if(!(V=Q.__stylesheet__)||V._lastStyleElement&&V._lastStyleElement.ownerDocument!==document){var e=Q&&Q.FabricConfig||{};V=Q.__stylesheet__=new t(e.mergeStyles)}return V},t.prototype.setConfig=function(t){this._config=i(i({},this._config),t)},t.prototype.onReset=function(t){this._onResetCallbacks.push(t)},t.prototype.getClassName=function(t){var e=this._config.namespace;return(e?e+"-":"")+(t||this._config.defaultPrefix)+"-"+this._counter++},t.prototype.cacheClassName=function(t,e,n,r){this._keyToClassName[e]=t,this._classNameToArgs[t]={args:n,rules:r}},t.prototype.classNameFromKey=function(t){return this._keyToClassName[t]},t.prototype.getClassNameCache=function(){return this._keyToClassName},t.prototype.argsFromClassName=function(t){var e=this._classNameToArgs[t];return e&&e.args},t.prototype.insertedRulesFromClassName=function(t){var e=this._classNameToArgs[t];return e&&e.rules},t.prototype.insertRule=function(t,e){var n=this._config.injectionMode!==X?this._getStyleElement():void 0;if(e&&this._preservedRules.push(t),n)switch(this._config.injectionMode){case $:var r=n.sheet;try{r.insertRule(t,r.cssRules.length)}catch(t){}break;case G:n.appendChild(document.createTextNode(t))}else this._rules.push(t);this._config.onInsertRule&&this._config.onInsertRule(t)},t.prototype.getRules=function(t){return(t?this._preservedRules.join(""):"")+this._rules.join("")+this._rulesToInsert.join("")},t.prototype.reset=function(){this._rules=[],this._rulesToInsert=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={},this._onResetCallbacks.forEach((function(t){return t()}))},t.prototype.resetKeys=function(){this._keyToClassName={}},t.prototype._getStyleElement=function(){var t=this;return this._styleElement||"undefined"==typeof document||(this._styleElement=this._createStyleElement(),J||window.requestAnimationFrame((function(){t._styleElement=void 0}))),this._styleElement},t.prototype._createStyleElement=function(){var t=document.head,e=document.createElement("style");e.setAttribute("data-merge-styles","true");var n=this._config.cspSettings;if(n&&n.nonce&&e.setAttribute("nonce",n.nonce),this._lastStyleElement)t.insertBefore(e,this._lastStyleElement.nextElementSibling);else{var r=this._findPlaceholderStyleTag();r?t.insertBefore(e,r.nextElementSibling):t.insertBefore(e,t.childNodes[0])}return this._lastStyleElement=e,e},t.prototype._findPlaceholderStyleTag=function(){var t=document.head;return t?t.querySelector("style[data-merge-styles]"):null},t}(),tt=v()||{};void 0===tt.__currentId__&&(tt.__currentId__=0);var et=!1;function nt(t){void 0===t&&(t=0),tt.__currentId__=t}var rt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n={},r=0,o=t;r<o.length;r++)for(var i=o[r],s=Array.isArray(i)?i:Object.keys(i),a=0,u=s;a<u.length;a++){var l=u[a];n[l]=1}return n},ot=rt(["onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),it=rt(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","role","style","tabIndex","title","translate","spellCheck","name"]),st=rt(it,ot),at=(rt(st,["form"]),rt(st,["height","loop","muted","preload","src","width"])),ut=(rt(at,["poster"]),rt(st,["start"]),rt(st,["value"]),rt(st,["download","href","hrefLang","media","rel","target","type"]),rt(st,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]));rt(ut,["accept","alt","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),rt(ut,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),rt(ut,["form","multiple","required"]),rt(st,["selected","value"]),rt(st,["cellPadding","cellSpacing"]),rt(st,["rowSpan","scope"]),rt(st,["colSpan","headers","rowSpan","scope"]),rt(st,["span"]),rt(st,["span"]),rt(st,["acceptCharset","action","encType","encType","method","noValidate","target"]),rt(st,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),rt(st,["alt","crossOrigin","height","src","srcSet","useMap","width"]);function lt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,o=t;r<o.length;r++){var i=o[r];if(i)if("string"==typeof i)n.push(i);else if(i.hasOwnProperty("toString")&&"function"==typeof i.toString)n.push(i.toString());else for(var s in i)i[s]&&n.push(s)}return n.join(" ")}function ct(t){var e=function(t){var e;"function"==typeof Event?e=new Event(t):(e=document.createEvent("Event")).initEvent(t,!0,!0);return e}("MouseEvents");e.initEvent("click",!0,!0),t.dispatchEvent(e)}var ft,ht={};var pt={"user-select":1};function dt(t,e){var n=function(){if(!ft){var t="undefined"!=typeof document?document:void 0,e="undefined"!=typeof navigator?navigator:void 0,n=e?e.userAgent.toLowerCase():void 0;ft=t?{isWebkit:!!(t&&"WebkitAppearance"in t.documentElement.style),isMoz:!!(n&&n.indexOf("firefox")>-1),isOpera:!!(n&&n.indexOf("opera")>-1),isMs:!(!e||!/rv:11.0/i.test(e.userAgent)&&!/Edge\/\d./i.test(navigator.userAgent))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return ft}(),r=t[e];if(pt[r]){var o=t[e+1];pt[r]&&(n.isWebkit&&t.push("-webkit-"+r,o),n.isMoz&&t.push("-moz-"+r,o),n.isMs&&t.push("-ms-"+r,o),n.isOpera&&t.push("-o-"+r,o))}}var vt,mt=["column-count","font-weight","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"];function _t(t,e){var n=t[e],r=t[e+1];if("number"==typeof r){var o=-1===mt.indexOf(n)?"px":"";t[e+1]=""+r+o}}var gt="left",bt="right",yt=((vt={}).left=bt,vt.right=gt,vt),Et={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"};function wt(t,e,n){if(t.rtl){var r=e[n];if(!r)return;var o=e[n+1];if("string"==typeof o&&o.indexOf("@noflip")>=0)e[n+1]=o.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(r.indexOf(gt)>=0)e[n]=r.replace(gt,bt);else if(r.indexOf(bt)>=0)e[n]=r.replace(bt,gt);else if(String(o).indexOf(gt)>=0)e[n+1]=o.replace(gt,bt);else if(String(o).indexOf(bt)>=0)e[n+1]=o.replace(bt,gt);else if(yt[r])e[n]=yt[r];else if(Et[o])e[n+1]=Et[o];else switch(r){case"margin":case"padding":e[n+1]=function(t){if("string"==typeof t){var e=t.split(" ");if(4===e.length)return e[0]+" "+e[3]+" "+e[2]+" "+e[1]}return t}(o);break;case"box-shadow":e[n+1]=function(t,e){var n=t.split(" "),r=parseInt(n[e],10);return n[0]=n[0].replace(String(r),String(-1*r)),n.join(" ")}(o,0)}}}function Ft(t){var e=t&&t["&"];return e?e.displayName:void 0}var At=/\:global\((.+?)\)/g;function Ct(t){if(!At.test(t))return t;for(var e=[],n=/\:global\((.+?)\)/g,r=null;r=n.exec(t);)r[1].indexOf(",")>-1&&e.push([r.index,r.index+r[0].length,r[1].split(",").map((function(t){return":global("+t.trim()+")"})).join(", ")]);return e.reverse().reduce((function(t,e){var n=e[0],r=e[1],o=e[2];return t.slice(0,n)+o+t.slice(r)}),t)}function xt(t,e){return t.indexOf(":global(")>=0?t.replace(At,"$1"):0===t.indexOf(":")?e+t:t.indexOf("&")<0?e+" "+t:t}function Tt(t,e,n){void 0===e&&(e={__order:[]}),void 0===n&&(n="&");var r=Y.getInstance(),o=e[n];o||(o={},e[n]=o,e.__order.push(n));for(var i=0,s=t;i<s.length;i++){var a=s[i];if("string"==typeof a){var u=r.argsFromClassName(a);u&&Tt(u,e,n)}else if(Array.isArray(a))Tt(a,e,n);else for(var l in a)if("selectors"===l){var c=a.selectors,f=function(t){if(c.hasOwnProperty(t)){var r=c[t];0===t.indexOf("@")?Tt([r],e,t=t+"{"+n):t.indexOf(",")>-1?Ct(t).split(",").map((function(t){return t.trim()})).forEach((function(t){return Tt([r],e,xt(t,n))})):Tt([r],e,xt(t,n))}};for(var h in c)f(h)}else void 0!==a[l]&&("margin"===l||"padding"===l?It(o,l,a[l]):o[l]=a[l])}return e}function It(t,e,n){var r="string"==typeof n?n.split(" "):[n];t[e+"Top"]=r[0],t[e+"Right"]=r[1]||r[0],t[e+"Bottom"]=r[2]||r[0],t[e+"Left"]=r[3]||r[1]||r[0]}function Ot(t,e){for(var n=[t.rtl?"rtl":"ltr"],r=!1,o=0,i=e.__order;o<i.length;o++){var s=i[o];n.push(s);var a=e[s];for(var u in a)a.hasOwnProperty(u)&&void 0!==a[u]&&(r=!0,n.push(u,a[u]))}return r?n.join(""):void 0}function kt(t,e){return e<=0?"":1===e?t:t+kt(t,e-1)}function Dt(t,e){if(!e)return"";var n,r,o,i=[];for(var s in e)e.hasOwnProperty(s)&&"displayName"!==s&&void 0!==e[s]&&i.push(s,e[s]);for(var a=0;a<i.length;a+=2)o=void 0,"-"!==(o=(n=i)[r=a]).charAt(0)&&(n[r]=ht[o]=ht[o]||o.replace(/([A-Z])/g,"-$1").toLowerCase()),_t(i,a),wt(t,i,a),dt(i,a);for(a=1;a<i.length;a+=4)i.splice(a,1,":",i[a],";");return i.join("")}function Nt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Tt(e),o=Ot(t,r);if(o){var i=Y.getInstance(),s={className:i.classNameFromKey(o),key:o,args:e};if(!s.className){s.className=i.getClassName(Ft(r));for(var a=[],u=0,l=r.__order;u<l.length;u++){var c=l[u];a.push(c,Dt(t,r[c]))}s.rulesToInsert=a}return s}}function Pt(t,e){void 0===e&&(e=1);var n=Y.getInstance(),r=t.className,o=t.key,i=t.args,s=t.rulesToInsert;if(s){for(var a=0;a<s.length;a+=2){var u=s[a+1];if(u){var l=s[a],c=(l=l.replace(/&/g,kt("."+t.className,e)))+"{"+u+"}"+(0===l.indexOf("@")?"}":"");n.insertRule(c)}}n.cacheClassName(r,o,i,s)}}function St(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Mt(t,z())}function Mt(t,e){var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=[],r=[],o=Y.getInstance();function i(t){for(var e=0,s=t;e<s.length;e++){var a=s[e];if(a)if("string"==typeof a)if(a.indexOf(" ")>=0)i(a.split(" "));else{var u=o.argsFromClassName(a);u?i(u):-1===n.indexOf(a)&&n.push(a)}else Array.isArray(a)?i(a):"object"==typeof a&&r.push(a)}}return i(t),{classes:n,objects:r}}(t instanceof Array?t:[t]),r=n.classes,o=n.objects;return o.length&&r.push(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Nt.apply(void 0,s([t],e));return r?(Pt(r,t.specificityMultiplier),r.className):""}(e||{},o)),r.join(" ")}St({overflow:"hidden !important"});function Rt(t){for(var e=t,n=m(t);e&&e!==n.body;){if("true"===e.getAttribute("data-is-scrollable"))return e;e=e.parentElement}for(e=t;e&&e!==n.body;){if("false"!==e.getAttribute("data-is-scrollable")){var r=getComputedStyle(e),o=r?r.getPropertyValue("overflow-y"):"";if(o&&("scroll"===o||"auto"===o))return e}e=e.parentElement}return e&&e!==n.body||(e=v(t)),e}var Lt;var zt={},Kt=new Set,jt=["text","number","password","email","tel","url","search"],Zt=function(t){function e(e){var n=t.call(this,e)||this;return n._root=u.createRef(),n._onFocus=function(t){if(!n._portalContainsElement(t.target)){var e,r=n.props,o=r.onActiveElementChanged,i=r.doNotAllowFocusEventToPropagate,s=r.stopFocusPropagation,a=r.onFocusNotification,u=r.onFocus,l=r.shouldFocusInnerElementWhenReceivedFocus,f=r.defaultTabbableElement,h=n._isImmediateDescendantOfZone(t.target);if(u?u(t):a&&a(),h)e=t.target;else for(var p=t.target;p&&p!==n._root.current;){if(y(p)&&n._isImmediateDescendantOfZone(p)){e=p;break}p=c(p,!1)}if(l&&t.target===n._root.current){var d=f&&"function"==typeof f&&f(n._root.current);d&&y(d)?(e=d,d.focus()):(n.focus(!0),n._activeElement&&(e=null))}var v=!n._activeElement;e&&e!==n._activeElement&&((h||v)&&n._setFocusAlignment(e,!0,!0),n._activeElement=e,v&&n._updateTabIndexes()),o&&o(n._activeElement,t),(s||i)&&t.stopPropagation()}},n._onBlur=function(){n._setParkedFocus(!1)},n._onKeyDownCapture=function(t){t.which===C&&Kt.forEach((function(t){return t._updateTabIndexes()}))},n._onMouseDown=function(t){if(!n._portalContainsElement(t.target)&&!n.props.disabled){for(var e=t.target,r=[];e&&e!==n._root.current;)r.push(e),e=c(e,!1);for(;r.length&&((e=r.pop())&&y(e)&&n._setActiveElement(e,!0),!E(e)););}},n._onKeyDown=function(t){if(!n._portalContainsElement(t.target)){var e=n.props,r=e.direction,o=e.disabled,i=e.isInnerZoneKeystroke,s=e.pagingSupportDisabled,u=e.shouldEnterInnerZone;if(!(o||(n.props.onKeyDown&&n.props.onKeyDown(t),t.isDefaultPrevented()||n._getDocument().activeElement===n._root.current&&n._isInnerZone))){if((u&&u(t)||i&&i(t))&&n._isImmediateDescendantOfZone(t.target)){var c=n._getFirstInnerZone();if(c){if(!c.focus(!0))return}else{if(!w(t.target))return;if(!n.focusElement(g(t.target,t.target.firstChild,!0)))return}}else{if(t.altKey)return;switch(t.which){case T:if(n._tryInvokeClickForFocusable(t.target))break;return;case N:if(r!==a.vertical&&(n._preventDefaultWhenHandled(t),n._moveFocusLeft()))break;return;case S:if(r!==a.vertical&&(n._preventDefaultWhenHandled(t),n._moveFocusRight()))break;return;case P:if(r!==a.horizontal&&(n._preventDefaultWhenHandled(t),n._moveFocusUp()))break;return;case M:if(r!==a.horizontal&&(n._preventDefaultWhenHandled(t),n._moveFocusDown()))break;return;case O:if(!s&&n._moveFocusPaging(!0))break;return;case I:if(!s&&n._moveFocusPaging(!1))break;return;case C:if(n.props.allowTabKey||n.props.handleTabKey===l.all||n.props.handleTabKey===l.inputOnly&&n._isElementInput(t.target)){var f=!1;if(n._processingTabKey=!0,r!==a.vertical&&n._shouldWrapFocus(n._activeElement,"data-no-horizontal-wrap"))f=(j()?!t.shiftKey:t.shiftKey)?n._moveFocusLeft():n._moveFocusRight();else f=t.shiftKey?n._moveFocusUp():n._moveFocusDown();if(n._processingTabKey=!1,f)break;n.props.shouldResetActiveElementWhenTabFromZone&&(n._activeElement=null)}return;case D:if(n._isContentEditableElement(t.target)||n._isElementInput(t.target)&&!n._shouldInputLoseFocus(t.target,!1))return!1;var h=n._root.current&&n._root.current.firstChild;if(n._root.current&&h&&n.focusElement(g(n._root.current,h,!0)))break;return;case k:if(n._isContentEditableElement(t.target)||n._isElementInput(t.target)&&!n._shouldInputLoseFocus(t.target,!0))return!1;var p=n._root.current&&n._root.current.lastChild;if(n._root.current&&n.focusElement(_(n._root.current,p,!0,!0,!0)))break;return;case x:if(n._tryInvokeClickForFocusable(t.target))break;return;default:return}}t.preventDefault(),t.stopPropagation()}}},n._getHorizontalDistanceFromCenter=function(t,e,r){var o=n._focusAlignment.left||n._focusAlignment.x||0,i=Math.floor(r.top),s=Math.floor(e.bottom),a=Math.floor(r.bottom),u=Math.floor(e.top);return t&&i>s||!t&&a<u?o>=r.left&&o<=r.left+r.width?0:Math.abs(r.left+r.width/2-o):n._shouldWrapFocus(n._activeElement,"data-no-vertical-wrap")?999999999:-999999999},W(n),n._id=function(t){if(!et){var e=Y.getInstance();e&&e.onReset&&e.onReset(nt),et=!0}return(t||"id__")+tt.__currentId__++}("FocusZone"),n._focusAlignment={left:0,top:0},n._processingTabKey=!1,n}return function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.getOuterZones=function(){return Kt.size},e.prototype.componentDidMount=function(){var t=this._root.current;if(zt[this._id]=this,t){this._windowElement=v(t);for(var e=c(t,!1);e&&e!==this._getDocument().body&&1===e.nodeType;){if(E(e)){this._isInnerZone=!0;break}e=c(e,!1)}this._isInnerZone||(Kt.add(this),this._windowElement&&1===Kt.size&&this._windowElement.addEventListener("keydown",this._onKeyDownCapture,!0)),this._root.current&&this._root.current.addEventListener("blur",this._onBlur,!0),this._updateTabIndexes(),this.props.defaultTabbableElement&&"string"==typeof this.props.defaultTabbableElement?this._activeElement=this._getDocument().querySelector(this.props.defaultTabbableElement):this.props.defaultActiveElement&&(this._activeElement=this._getDocument().querySelector(this.props.defaultActiveElement)),this.props.shouldFocusOnMount&&this.focus()}},e.prototype.componentDidUpdate=function(){var t=this._root.current,e=this._getDocument();if(e&&this._lastIndexPath&&(e.activeElement===e.body||null===e.activeElement||!this.props.preventFocusRestoration&&e.activeElement===t)){var n=function(t,e){for(var n=t,r=0,o=e;r<o.length;r++){var i=o[r],s=n.children[Math.min(i,n.children.length-1)];if(!s)break;n=s}return n=y(n)&&b(n)?n:g(t,n,!0)||_(t,n)}(t,this._lastIndexPath);n?(this._setActiveElement(n,!0),n.focus(),this._setParkedFocus(!1)):this._setParkedFocus(!0)}},e.prototype.componentWillUnmount=function(){delete zt[this._id],this._isInnerZone||(Kt.delete(this),this._windowElement&&0===Kt.size&&this._windowElement.removeEventListener("keydown",this._onKeyDownCapture,!0)),this._root.current&&this._root.current.removeEventListener("blur",this._onBlur,!0),this._activeElement=null,this._defaultFocusElement=null},e.prototype.render=function(){var t=this.props,e=t.as,n=t.elementType,r=t.rootProps,o=t.ariaDescribedBy,s=t.ariaLabelledBy,a=t.className,l=function(t,e,n){for(var r,o=Array.isArray(e),i={},s=0,a=Object.keys(t);s<a.length;s++){var u=a[s];!(!o&&e[u]||o&&e.indexOf(u)>=0||0===u.indexOf("data-")||0===u.indexOf("aria-"))||n&&-1!==(null===(r=n)||void 0===r?void 0:r.indexOf(u))||(i[u]=t[u])}return i}(this.props,st),c=e||n||"div";return this._evaluateFocusBeforeRender(),u.createElement(c,i({"aria-labelledby":s,"aria-describedby":o},l,r,{className:lt((Lt||(Lt=St({selectors:{":focus":{outline:"none"}}},"ms-FocusZone")),Lt),a),ref:this._root,"data-focuszone-id":this._id,onKeyDown:this._onKeyDown,onFocus:this._onFocus,onMouseDownCapture:this._onMouseDown}),this.props.children)},e.prototype.focus=function(t){if(void 0===t&&(t=!1),this._root.current){if(!t&&"true"===this._root.current.getAttribute("data-is-focusable")&&this._isInnerZone){var e=this._getOwnerZone(this._root.current);if(e!==this._root.current){var n=zt[e.getAttribute("data-focuszone-id")];return!!n&&n.focusElement(this._root.current)}return!1}if(!t&&this._activeElement&&h(this._root.current,this._activeElement)&&y(this._activeElement))return this._activeElement.focus(),!0;var r=this._root.current.firstChild;return this.focusElement(g(this._root.current,r,!0))}return!1},e.prototype.focusLast=function(){if(this._root.current){var t=this._root.current&&this._root.current.lastChild;return this.focusElement(_(this._root.current,t,!0,!0,!0))}return!1},e.prototype.focusElement=function(t){var e=this.props,n=e.onBeforeFocus,r=e.shouldReceiveFocus;return!(r&&!r(t)||n&&!n(t))&&(!!t&&(this._setActiveElement(t),this._activeElement&&this._activeElement.focus(),!0))},e.prototype.setFocusAlignment=function(t){this._focusAlignment=t},e.prototype._evaluateFocusBeforeRender=function(){var t=this._root.current,e=this._getDocument();if(e){var n=e.activeElement;if(n!==t){var r=h(t,n,!1);this._lastIndexPath=r?function(t,e){for(var n=[];e&&t&&e!==t;){var r=c(e,!0);if(null===r)return[];n.unshift(Array.prototype.indexOf.call(r.children,e)),e=r}return n}(t,n):void 0}}},e.prototype._setParkedFocus=function(t){var e=this._root.current;e&&this._isParked!==t&&(this._isParked=t,t?(this.props.allowFocusRoot||(this._parkedTabIndex=e.getAttribute("tabindex"),e.setAttribute("tabindex","-1")),e.focus()):this.props.allowFocusRoot||(this._parkedTabIndex?(e.setAttribute("tabindex",this._parkedTabIndex),this._parkedTabIndex=void 0):e.removeAttribute("tabindex")))},e.prototype._setActiveElement=function(t,e){var n=this._activeElement;this._activeElement=t,n&&(E(n)&&this._updateTabIndexes(n),n.tabIndex=-1),this._activeElement&&(this._focusAlignment&&!e||this._setFocusAlignment(t,!0,!0),this._activeElement.tabIndex=0)},e.prototype._preventDefaultWhenHandled=function(t){this.props.preventDefaultWhenHandled&&t.preventDefault()},e.prototype._tryInvokeClickForFocusable=function(t){if(t===this._root.current||!this.props.shouldRaiseClicks)return!1;do{if("BUTTON"===t.tagName||"A"===t.tagName||"INPUT"===t.tagName||"TEXTAREA"===t.tagName)return!1;if(this._isImmediateDescendantOfZone(t)&&"true"===t.getAttribute("data-is-focusable")&&"true"!==t.getAttribute("data-disable-click-on-enter"))return ct(t),!0;t=c(t,!1)}while(t!==this._root.current);return!1},e.prototype._getFirstInnerZone=function(t){if(!(t=t||this._activeElement||this._root.current))return null;if(E(t))return zt[t.getAttribute("data-focuszone-id")];for(var e=t.firstElementChild;e;){if(E(e))return zt[e.getAttribute("data-focuszone-id")];var n=this._getFirstInnerZone(e);if(n)return n;e=e.nextElementSibling}return null},e.prototype._moveFocus=function(t,e,n,r){void 0===r&&(r=!0);var o=this._activeElement,i=-1,s=void 0,u=!1,l=this.props.direction===a.bidirectional;if(!o||!this._root.current)return!1;if(this._isElementInput(o)&&!this._shouldInputLoseFocus(o,t))return!1;var c=l?o.getBoundingClientRect():null;do{if(o=t?g(this._root.current,o):_(this._root.current,o),!l){s=o;break}if(o){var f=e(c,o.getBoundingClientRect());if(-1===f&&-1===i){s=o;break}if(f>-1&&(-1===i||f<i)&&(i=f,s=o),i>=0&&f<0)break}}while(o);if(s&&s!==this._activeElement)u=!0,this.focusElement(s);else if(this.props.isCircularNavigation&&r)return t?this.focusElement(g(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement(_(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return u},e.prototype._moveFocusDown=function(){var t=this,e=-1,n=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!0,(function(r,o){var i=-1,s=Math.floor(o.top),a=Math.floor(r.bottom);return s<a?t._shouldWrapFocus(t._activeElement,"data-no-vertical-wrap")?999999999:-999999999:((-1===e&&s>=a||s===e)&&(e=s,i=n>=o.left&&n<=o.left+o.width?0:Math.abs(o.left+o.width/2-n)),i)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},e.prototype._moveFocusUp=function(){var t=this,e=-1,n=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!1,(function(r,o){var i=-1,s=Math.floor(o.bottom),a=Math.floor(o.top),u=Math.floor(r.top);return s>u?t._shouldWrapFocus(t._activeElement,"data-no-vertical-wrap")?999999999:-999999999:((-1===e&&s<=u||a===e)&&(e=a,i=n>=o.left&&n<=o.left+o.width?0:Math.abs(o.left+o.width/2-n)),i)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},e.prototype._moveFocusLeft=function(){var t=this,e=this._shouldWrapFocus(this._activeElement,"data-no-horizontal-wrap");return!!this._moveFocus(j(),(function(n,r){var o=-1;return(j()?parseFloat(r.top.toFixed(3))<parseFloat(n.bottom.toFixed(3)):parseFloat(r.bottom.toFixed(3))>parseFloat(n.top.toFixed(3)))&&r.right<=n.right&&t.props.direction!==a.vertical?o=n.right-r.right:e||(o=-999999999),o}),void 0,e)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},e.prototype._moveFocusRight=function(){var t=this,e=this._shouldWrapFocus(this._activeElement,"data-no-horizontal-wrap");return!!this._moveFocus(!j(),(function(n,r){var o=-1;return(j()?parseFloat(r.bottom.toFixed(3))>parseFloat(n.top.toFixed(3)):parseFloat(r.top.toFixed(3))<parseFloat(n.bottom.toFixed(3)))&&r.left>=n.left&&t.props.direction!==a.vertical?o=r.left-n.left:e||(o=-999999999),o}),void 0,e)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},e.prototype._moveFocusPaging=function(t,e){void 0===e&&(e=!0);var n=this._activeElement;if(!n||!this._root.current)return!1;if(this._isElementInput(n)&&!this._shouldInputLoseFocus(n,t))return!1;var r=Rt(n);if(!r)return!1;var o=-1,i=void 0,s=-1,a=-1,u=r.clientHeight,l=n.getBoundingClientRect();do{if(n=t?g(this._root.current,n):_(this._root.current,n)){var c=n.getBoundingClientRect(),f=Math.floor(c.top),h=Math.floor(l.bottom),p=Math.floor(c.bottom),d=Math.floor(l.top),v=this._getHorizontalDistanceFromCenter(t,l,c);if(t&&f>h+u||!t&&p<d-u)break;v>-1&&(t&&f>s?(s=f,o=v,i=n):!t&&p<a?(a=p,o=v,i=n):(-1===o||v<=o)&&(o=v,i=n))}}while(n);var m=!1;if(i&&i!==this._activeElement)m=!0,this.focusElement(i),this._setFocusAlignment(i,!1,!0);else if(this.props.isCircularNavigation&&e)return t?this.focusElement(g(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement(_(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return m},e.prototype._setFocusAlignment=function(t,e,n){if(this.props.direction===a.bidirectional&&(!this._focusAlignment||e||n)){var r=t.getBoundingClientRect(),o=r.left+r.width/2,i=r.top+r.height/2;this._focusAlignment||(this._focusAlignment={left:o,top:i}),e&&(this._focusAlignment.left=o),n&&(this._focusAlignment.top=i)}},e.prototype._isImmediateDescendantOfZone=function(t){return this._getOwnerZone(t)===this._root.current},e.prototype._getOwnerZone=function(t){for(var e=c(t,!1);e&&e!==this._root.current&&e!==this._getDocument().body;){if(E(e))return e;e=c(e,!1)}return e},e.prototype._updateTabIndexes=function(t){!this._activeElement&&this.props.defaultTabbableElement&&"function"==typeof this.props.defaultTabbableElement&&(this._activeElement=this.props.defaultTabbableElement(this._root.current)),!t&&this._root.current&&(this._defaultFocusElement=null,t=this._root.current,this._activeElement&&!h(t,this._activeElement)&&(this._activeElement=null)),this._activeElement&&!y(this._activeElement)&&(this._activeElement=null);for(var e=t&&t.children,n=0;e&&n<e.length;n++){var r=e[n];E(r)?"true"===r.getAttribute("data-is-focusable")&&(this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==r?"-1"!==r.getAttribute("tabindex")&&r.setAttribute("tabindex","-1"):(this._defaultFocusElement=r,"0"!==r.getAttribute("tabindex")&&r.setAttribute("tabindex","0"))):(r.getAttribute&&"false"===r.getAttribute("data-is-focusable")&&r.setAttribute("tabindex","-1"),y(r)?this.props.disabled?r.setAttribute("tabindex","-1"):this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==r?"-1"!==r.getAttribute("tabindex")&&r.setAttribute("tabindex","-1"):(this._defaultFocusElement=r,"0"!==r.getAttribute("tabindex")&&r.setAttribute("tabindex","0")):"svg"===r.tagName&&"false"!==r.getAttribute("focusable")&&r.setAttribute("focusable","false")),this._updateTabIndexes(r)}},e.prototype._isContentEditableElement=function(t){return t&&"true"===t.getAttribute("contenteditable")},e.prototype._isElementInput=function(t){return!(!t||!t.tagName||"input"!==t.tagName.toLowerCase()&&"textarea"!==t.tagName.toLowerCase())},e.prototype._shouldInputLoseFocus=function(t,e){if(!this._processingTabKey&&t&&t.type&&jt.indexOf(t.type.toLowerCase())>-1){var n=t.selectionStart,r=n!==t.selectionEnd,o=t.value,i=t.readOnly;if(r||n>0&&!e&&!i||n!==o.length&&e&&!i||this.props.handleTabKey&&(!this.props.shouldInputLoseFocusOnArrowKey||!this.props.shouldInputLoseFocusOnArrowKey(t)))return!1}return!0},e.prototype._shouldWrapFocus=function(t,e){return!this.props.checkForNoWrap||F(t,e)},e.prototype._portalContainsElement=function(t){return t&&!!this._root.current&&(e=t,n=this._root.current,null!==(r=f(e,(function(t){return n===t||t.hasAttribute("data-portal-element")})))&&r.hasAttribute("data-portal-element"));var e,n,r},e.prototype._getDocument=function(){return m(this._root.current)},e.defaultProps={isCircularNavigation:!1,direction:a.bidirectional,shouldRaiseClicks:!0},e}(u.Component)}]);
//# sourceMappingURL=react-focus.min.js.map